//0C33C6C25F5221E8361CD3A2B106302B
//2B67681797CEE4F1643D886DE38C51F2
//D8F7266AB2B039FF8D98417F8537C4BA
//F25BB3F83151147E177AAA39913BA3EC

import "pe"
rule Crypto_Malware_Anti_AV
{
	strings:
		$a = { FF 74 24 10 E8 28 85 00 00 C2 10 00 }  //Maincode
		$b = { 83 CB FF E8 5F ED FF FF 8B F0 E8 57 34 00 00 FF 74 24 1C 8B } //inside main function
		$c = "BthUdTask.exe"
		$d = "https://map.baidu.com"
		
		$antiav1 = "avast" nocase
		$antiav2 = "avgguard.exe" nocase
		$antiav3 = "360tray.exe" nocase
		$antiav4 = "Bitdefender" nocase
		$antiav5 = "Nod32" nocase
		
	condition:
		uint16(0) == 0x5A4D and
		filesize > 1000KB and
		filesize < 2000KB and
		uint32(0x18c) == 0x00000104 and    //Import Size
		pe.number_of_sections == 4 and 
		$a in (0xc1000..0xDc000) and
		$b in (0xD0000..0xE0000) and
		$c in (0xC1000..0xF0000) and
		$d and
		1 of ($antiav*)
}